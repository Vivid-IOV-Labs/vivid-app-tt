{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.string.includes.js","webpack:///./node_modules/core-js/internals/is-regexp.js","webpack:///./node_modules/core-js/internals/not-a-regexp.js","webpack:///./node_modules/core-js/modules/es.array.splice.js","webpack:///./node_modules/core-js/internals/correct-is-regexp-logic.js","webpack:///./src/util/webrtc_adaptor.js","webpack:///./node_modules/core-js/modules/es.array.index-of.js","webpack:///./node_modules/core-js/modules/es.array.includes.js"],"names":["$","notARegExp","requireObjectCoercible","correctIsRegExpLogic","target","proto","forced","includes","searchString","String","this","indexOf","arguments","length","undefined","isObject","classof","wellKnownSymbol","MATCH","module","exports","it","isRegExp","TypeError","toAbsoluteIndex","toInteger","toLength","toObject","arraySpeciesCreate","createProperty","arrayMethodHasSpeciesSupport","arrayMethodUsesToLength","HAS_SPECIES_SUPPORT","USES_TO_LENGTH","ACCESSORS","0","1","max","Math","min","MAX_SAFE_INTEGER","MAXIMUM_ALLOWED_LENGTH_EXCEEDED","splice","start","deleteCount","insertCount","actualDeleteCount","A","k","from","to","O","len","actualStart","argumentsLength","METHOD_NAME","regexp","error1","error2","WebRTCAdaptor","initialValues","thiz","key","peerconnection_config","sdp_constraints","remotePeerConnection","Array","remoteDescriptionSet","iceCandidateList","webSocketAdaptor","roomName","videoTrackSender","audioTrackSender","playStreamId","micGainNode","localStream","isPlayMode","debug","camera_location","camera_margin","camera_percent","Object","prototype","hasOwnProperty","call","localVideo","localVideoId","remoteVideo","remoteVideoId","window","devLog","callbackError","navigator","mediaDevices","getUserMedia","mediaConstraints","audioConstraint","then","stream","audioTrack","getAudioTracks","removeTrack","video","mandatory","chromeMediaSource","getVideoTracks","onended","callback","media_audio_constraint","audio","audioStream","cameraStream","canvas","document","createElement","canvasContext","getContext","screenVideo","srcObject","play","cameraVideo","canvasStream","captureStream","addTrack","gotStream","setInterval","width","videoWidth","height","videoHeight","drawImage","positionY","cameraWidth","cameraHeight","positionX","catch","error","name","message","openScreen","data","postMessage","sourceId","chromeMediaSourceId","optional","removeEventListener","addEventListener","openStream","closeStream","getTracks","forEach","track","readyState","stop","checkExtension","isConnected","WebSocketAdaptor","micStream","audioContext","AudioContext","desktopSoundGainNode","createGain","gain","value","audioDestionation","createMediaStreamDestination","audioSource","createMediaStreamSource","connect","audioSource2","mode","wsConn","WebSocket","websocket_url","connected","pingTimerId","clearPingTimer","clearInterval","sendPing","send","jsCmd","command","JSON","stringify","close","onopen","text","onmessage","event","obj","parse","startPublishing","streamId","candidate","takeCandidate","label","type","takeConfiguration","sdp","closePeerConnection","definition","onerror","onclose","enableMicInMixedAudio","enable","publish","token","joinRoom","room","roomId","push","join","leaveFromRoom","leave","getStreamInfo","switchVideoCapture","switchVideoSource","switchDesktopCapture","screenShareExtensionCallback","arrangeStreams","onEndedCallback","videoTrack","getSenders","find","s","kind","replaceTrack","onTrack","streams","dataObj","iceCandidateReceived","sdpMLineIndex","id","sdpMid","initPeerConnection","closedStreamId","RTCPeerConnection","addStream","onicecandidate","ontrack","signalingState","playStreamIndex","signallingState","iceConnectionState","gotDescription","configuration","setLocalDescription","turnOffLocalCamera","enabled","turnOnLocalCamera","muteLocalMic","unmuteLocalMic","idOfStream","typeOfConfiguration","conf","setRemoteDescription","RTCSessionDescription","response","i","addIceCandidate","createAnswer","idOfTheStream","tmpLabel","tmpCandidate","candidateSdp","RTCIceCandidate","createOffer","closeWebSocket","$indexOf","arrayMethodIsStrict","nativeIndexOf","NEGATIVE_ZERO","STRICT_METHOD","searchElement","apply","$includes","addToUnscopables","el"],"mappings":"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","file":"js/SupplyStream~ViewStream.ea63c276.js","sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\n\n// `String.prototype.includes` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.includes\n$({ target: 'String', proto: true, forced: !correctIsRegExpLogic('includes') }, {\n  includes: function includes(searchString /* , position = 0 */) {\n    return !!~String(requireObjectCoercible(this))\n      .indexOf(notARegExp(searchString), arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","var isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\n// `IsRegExp` abstract operation\n// https://tc39.github.io/ecma262/#sec-isregexp\nmodule.exports = function (it) {\n  var isRegExp;\n  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : classof(it) == 'RegExp');\n};\n","var isRegExp = require('../internals/is-regexp');\n\nmodule.exports = function (it) {\n  if (isRegExp(it)) {\n    throw TypeError(\"The method doesn't accept regular expressions\");\n  } return it;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toInteger = require('../internals/to-integer');\nvar toLength = require('../internals/to-length');\nvar toObject = require('../internals/to-object');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar createProperty = require('../internals/create-property');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('splice');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('splice', { ACCESSORS: true, 0: 0, 1: 2 });\n\nvar max = Math.max;\nvar min = Math.min;\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_LENGTH_EXCEEDED = 'Maximum allowed length exceeded';\n\n// `Array.prototype.splice` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.splice\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  splice: function splice(start, deleteCount /* , ...items */) {\n    var O = toObject(this);\n    var len = toLength(O.length);\n    var actualStart = toAbsoluteIndex(start, len);\n    var argumentsLength = arguments.length;\n    var insertCount, actualDeleteCount, A, k, from, to;\n    if (argumentsLength === 0) {\n      insertCount = actualDeleteCount = 0;\n    } else if (argumentsLength === 1) {\n      insertCount = 0;\n      actualDeleteCount = len - actualStart;\n    } else {\n      insertCount = argumentsLength - 2;\n      actualDeleteCount = min(max(toInteger(deleteCount), 0), len - actualStart);\n    }\n    if (len + insertCount - actualDeleteCount > MAX_SAFE_INTEGER) {\n      throw TypeError(MAXIMUM_ALLOWED_LENGTH_EXCEEDED);\n    }\n    A = arraySpeciesCreate(O, actualDeleteCount);\n    for (k = 0; k < actualDeleteCount; k++) {\n      from = actualStart + k;\n      if (from in O) createProperty(A, k, O[from]);\n    }\n    A.length = actualDeleteCount;\n    if (insertCount < actualDeleteCount) {\n      for (k = actualStart; k < len - actualDeleteCount; k++) {\n        from = k + actualDeleteCount;\n        to = k + insertCount;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n      for (k = len; k > len - actualDeleteCount + insertCount; k--) delete O[k - 1];\n    } else if (insertCount > actualDeleteCount) {\n      for (k = len - actualDeleteCount; k > actualStart; k--) {\n        from = k + actualDeleteCount - 1;\n        to = k + insertCount - 1;\n        if (from in O) O[to] = O[from];\n        else delete O[to];\n      }\n    }\n    for (k = 0; k < insertCount; k++) {\n      O[k + actualStart] = arguments[k + 2];\n    }\n    O.length = len - actualDeleteCount + insertCount;\n    return A;\n  }\n});\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\nmodule.exports = function (METHOD_NAME) {\n  var regexp = /./;\n  try {\n    '/./'[METHOD_NAME](regexp);\n  } catch (error1) {\n    try {\n      regexp[MATCH] = false;\n      return '/./'[METHOD_NAME](regexp);\n    } catch (error2) { /* empty */ }\n  } return false;\n};\n","/**\n *\n * @returns\n */\nimport devLog from \"@/util/devlog.js\";\nexport function WebRTCAdaptor(initialValues) {\n  var thiz = this;\n  thiz.peerconnection_config = null;\n  thiz.sdp_constraints = null;\n  thiz.remotePeerConnection = new Array();\n  thiz.remoteDescriptionSet = new Array();\n  thiz.iceCandidateList = new Array();\n  thiz.webSocketAdaptor = null;\n  thiz.roomName = null;\n  thiz.videoTrackSender = null;\n  thiz.audioTrackSender = null;\n  thiz.playStreamId = new Array();\n  thiz.micGainNode = null;\n  thiz.localStream = null;\n\n  thiz.isPlayMode = false;\n  thiz.debug = false;\n\n  /**\n   * The cam_location below is effective when camera and screen is send at the same time.\n   * possible values are top and bottom. It's on right all the time\n   */\n  thiz.camera_location = \"top\";\n\n  /**\n   * The cam_margin below is effective when camera and screen is send at the same time.\n   * This is the margin value in px from the edges\n   */\n  thiz.camera_margin = 15;\n\n  /**\n   * Thiz camera_percent is how large the camera view appear on the screen. It's %15 by default.\n   */\n  thiz.camera_percent = 15;\n\n  for (var key in initialValues) {\n    //if (initialValues.hasOwnProperty(key)) {\n    if (Object.prototype.hasOwnProperty.call(initialValues, key)) {\n      this[key] = initialValues[key];\n    }\n  }\n\n  thiz.localVideo = thiz.localVideoId;\n  thiz.remoteVideo = thiz.remoteVideoId;\n\n  if (!(\"WebSocket\" in window)) {\n    devLog(\"WebSocket not supported.\");\n    thiz.callbackError(\"WebSocketNotSupported\");\n    return;\n  }\n\n  if (\n    typeof navigator.mediaDevices == \"undefined\" &&\n    thiz.isPlayMode == false\n  ) {\n    devLog(\n      \"Cannot open camera and mic because of unsecure context. Please Install SSL(https)\"\n    );\n    thiz.callbackError(\"UnsecureContext\");\n    return;\n  }\n\n  /**\n   * Get user media\n   */\n  this.getUserMedia = function(mediaConstraints, audioConstraint) {\n    navigator.mediaDevices\n      .getUserMedia(mediaConstraints)\n      .then(function(stream) {\n        //this trick, getting audio and video separately, make us add or remove tracks on the fly\n        var audioTrack = stream.getAudioTracks();\n        if (audioTrack.length > 0) {\n          stream.removeTrack(audioTrack[0]);\n        }\n\n        //add callback if desktop is sharing\n        if (\n          mediaConstraints.video != \"undefined\" &&\n          typeof mediaConstraints.video.mandatory != \"undefined\" &&\n          typeof mediaConstraints.video.mandatory.chromeMediaSource !=\n            \"undefined\" &&\n          mediaConstraints.video.mandatory.chromeMediaSource == \"desktop\"\n        ) {\n          stream.getVideoTracks()[0].onended = function() {\n            thiz.callback(\"screen_share_stopped\");\n          };\n        }\n\n        //now get only audio to add this stream\n        if (audioConstraint != \"undefined\" && audioConstraint != false) {\n          var media_audio_constraint = { audio: audioConstraint };\n          navigator.mediaDevices\n            .getUserMedia(media_audio_constraint)\n            .then(function(audioStream) {\n              if (\n                thiz.mediaConstraints != \"undefined\" &&\n                thiz.mediaConstraints.video == \"screen+camera\"\n              ) {\n                navigator.mediaDevices\n                  .getUserMedia({ video: true, audio: false })\n                  .then(function(cameraStream) {\n                    //create a canvas element\n                    var canvas = document.createElement(\"canvas\");\n                    var canvasContext = canvas.getContext(\"2d\");\n\n                    //create video element for screen\n                    //var screenVideo = document.getElementById('sourceVideo');\n                    var screenVideo = document.createElement(\"video\");\n                    //TODO: check audio track\n                    screenVideo.srcObject = stream;\n                    screenVideo.play();\n\n                    //create video element for camera\n                    var cameraVideo = document.createElement(\"video\");\n                    //TODO: check audio track\n                    cameraVideo.srcObject = cameraStream;\n                    cameraVideo.play();\n\n                    var canvasStream = canvas.captureStream(15);\n                    canvasStream.addTrack(audioStream.getAudioTracks()[0]);\n                    //call gotStream\n                    thiz.gotStream(canvasStream);\n\n                    //update the canvas\n                    setInterval(function() {\n                      //draw screen to canvas\n                      canvas.width = screenVideo.videoWidth;\n                      canvas.height = screenVideo.videoHeight;\n                      canvasContext.drawImage(\n                        screenVideo,\n                        0,\n                        0,\n                        canvas.width,\n                        canvas.height\n                      );\n\n                      var cameraWidth =\n                        screenVideo.videoWidth * (thiz.camera_percent / 100);\n                      var cameraHeight =\n                        (cameraVideo.videoHeight / cameraVideo.videoWidth) *\n                        cameraWidth;\n\n                      var positionX =\n                        canvas.width - cameraWidth - thiz.camera_margin;\n                      var positionY;\n\n                      if (thiz.camera_location == \"top\") {\n                        positionY = thiz.camera_margin;\n                      } else {\n                        //if not top, make it bottom\n                        //draw camera on right bottom corner\n                        positionY =\n                          canvas.height - cameraHeight - thiz.camera_margin;\n                      }\n\n                      canvasContext.drawImage(\n                        cameraVideo,\n                        positionX,\n                        positionY,\n                        cameraWidth,\n                        cameraHeight\n                      );\n                    }, 66);\n                  })\n                  .catch(function(error) {\n                    thiz.callbackError(error.name, error.message);\n                  });\n              } else {\n                stream.addTrack(audioStream.getAudioTracks()[0]);\n                thiz.gotStream(stream);\n              }\n            })\n            .catch(function(error) {\n              thiz.callbackError(error.name, error.message);\n            });\n        } else {\n          // stream.addTrack(audioStream.getAudioTracks()[0]);\n          // thiz.gotStream(stream);\n        }\n      })\n      .catch(function(error) {\n        thiz.callbackError(error.name, error.message);\n      });\n  };\n\n  this.openScreen = function(audioConstraint) {\n    var callback = function(message) {\n      if (message.data == \"rtcmulticonnection-extension-loaded\") {\n        devLog(\"rtcmulticonnection-extension-loaded parameter is received\");\n        window.postMessage(\"get-sourceId\", \"*\");\n      } else if (message.data == \"PermissionDeniedError\") {\n        devLog(\"Permission denied error\");\n        thiz.callbackError(\"screen_share_permission_denied\");\n      } else if (message.data && message.data.sourceId) {\n        var mediaConstraints = {\n          audio: false,\n          video: {\n            mandatory: {\n              chromeMediaSource: \"desktop\",\n              chromeMediaSourceId: message.data.sourceId\n            },\n            optional: []\n          }\n        };\n\n        thiz.getUserMedia(mediaConstraints, audioConstraint);\n\n        //remove event listener\n        window.removeEventListener(\"message\", callback);\n      }\n    };\n    window.addEventListener(\"message\", callback, false);\n\n    window.postMessage(\"are-you-there\", \"*\");\n  };\n\n  /**\n   * Open media stream, it may be screen, camera or audio\n   */\n  this.openStream = function(mediaConstraints) {\n    thiz.mediaConstraints = mediaConstraints;\n    var audioConstraint = false;\n    if (\n      typeof mediaConstraints.audio != \"undefined\" &&\n      mediaConstraints.audio != false\n    ) {\n      audioConstraint = mediaConstraints.audio;\n    }\n\n    if (typeof mediaConstraints.video != \"undefined\") {\n      if (\n        mediaConstraints.video == \"screen+camera\" ||\n        mediaConstraints.video == \"screen\"\n      ) {\n        this.openScreen(audioConstraint);\n      } else {\n        thiz.getUserMedia(mediaConstraints, audioConstraint);\n      }\n    } else {\n      devLog(\"MediaConstraint video is not defined\");\n      thiz.callbackError(\"media_constraint_video_not_defined\");\n    }\n  };\n\n  /**\n   * Closes stream, if you want to stop peer connection, call stop (streamId)\n   */\n  this.closeStream = function() {\n    thiz.localStream.getTracks().forEach(function(track) {\n      if (track.readyState == \"live\") {\n        track.onended = () => devLog(\"ended\", track);\n        track.stop();\n      }\n    });\n  };\n\n  /**\n   * Checks chrome screen share extension is avaiable\n   * if exists it call callback with \"screen_share_extension_available\"\n   */\n  this.checkExtension = function() {\n    var callback = function(message) {\n      if (message.data == \"rtcmulticonnection-extension-loaded\") {\n        thiz.callback(\"screen_share_extension_available\");\n        window.removeEventListener(\"message\", callback);\n      }\n    };\n    //add event listener for desktop capture\n    window.addEventListener(\"message\", callback, false);\n\n    window.postMessage(\"are-you-there\", \"*\");\n  };\n\n  /*\n   * Call check extension. Below function is called when this class is created\n   */\n  thiz.checkExtension();\n\n  /*\n   * Below lines are executed as well when this class is created\n   */\n  if (\n    !this.isPlayMode &&\n    typeof thiz.mediaConstraints != \"undefined\" &&\n    this.localStream == null\n  ) {\n    if (\n      typeof thiz.mediaConstraints.video != \"undefined\" &&\n      thiz.mediaConstraints.video != false\n    ) {\n      // if it is not play mode and media constraint is defined, try to get user media\n      if (thiz.mediaConstraints.audio.mandatory) {\n        //this case captures mic and video(audio(screen audio) + video(screen)) and then provide mute/unmute mic with\n        //enableMicInMixedAudio\n        navigator.mediaDevices\n          .getUserMedia({ audio: true, video: false })\n          .then(function(micStream) {\n            navigator.mediaDevices\n              .getUserMedia(thiz.mediaConstraints)\n              .then(function(stream) {\n                //devLog(\"audio stream track count: \" + audioStream.getAudioTracks().length);\n\n                var audioContext = new AudioContext();\n                var desktopSoundGainNode = audioContext.createGain();\n\n                desktopSoundGainNode.gain.value = 1;\n\n                var audioDestionation = audioContext.createMediaStreamDestination();\n                var audioSource = audioContext.createMediaStreamSource(stream);\n\n                audioSource.connect(desktopSoundGainNode);\n\n                thiz.micGainNode = audioContext.createGain();\n                thiz.micGainNode.gain.value = 1;\n                var audioSource2 = audioContext.createMediaStreamSource(\n                  micStream\n                );\n                audioSource2.connect(thiz.micGainNode);\n\n                desktopSoundGainNode.connect(audioDestionation);\n                thiz.micGainNode.connect(audioDestionation);\n\n                stream.removeTrack(stream.getAudioTracks()[0]);\n                audioDestionation.stream\n                  .getAudioTracks()\n                  .forEach(function(track) {\n                    stream.addTrack(track);\n                  });\n\n                devLog(\"Running gotStream\");\n                thiz.gotStream(stream);\n              })\n              .catch(function(error) {\n                thiz.callbackError(error.name, error.message);\n              });\n          })\n          .catch(function(error) {\n            thiz.callbackError(error.name, error.message);\n          });\n      } else {\n        //most of the times, this statement runs\n        thiz.openStream(thiz.mediaConstraints, thiz.mode);\n      }\n    } else {\n      // get only audio\n      var media_audio_constraint = { audio: thiz.mediaConstraints.audio };\n      navigator.mediaDevices\n        .getUserMedia(media_audio_constraint)\n        .then(function(stream) {\n          thiz.gotStream(stream);\n        })\n        .catch(function(error) {\n          thiz.callbackError(error.name, error.message);\n        });\n    }\n  } else {\n    //just playing, it does not open any stream\n    if (\n      thiz.webSocketAdaptor == null ||\n      thiz.webSocketAdaptor.isConnected() == false\n    ) {\n      thiz.webSocketAdaptor = new WebSocketAdaptor();\n    }\n  }\n\n  this.enableMicInMixedAudio = function(enable) {\n    if (thiz.micGainNode != null) {\n      if (enable) {\n        thiz.micGainNode.gain.value = 1;\n      } else {\n        thiz.micGainNode.gain.value = 0;\n      }\n    }\n  };\n\n  this.publish = function(streamId, token) {\n    var jsCmd = {\n      command: \"publish\",\n      streamId: streamId,\n      token: token,\n      video: thiz.localStream.getVideoTracks().length > 0 ? true : false,\n      audio: thiz.localStream.getAudioTracks().length > 0 ? true : false\n    };\n\n    thiz.webSocketAdaptor.send(JSON.stringify(jsCmd));\n  };\n\n  this.joinRoom = function(roomName, streamId) {\n    thiz.roomName = roomName;\n\n    var jsCmd = {\n      command: \"joinRoom\",\n      room: roomName,\n      streamId: streamId\n    };\n\n    thiz.webSocketAdaptor.send(JSON.stringify(jsCmd));\n  };\n\n  this.play = function(streamId, token, roomId) {\n    thiz.playStreamId.push(streamId);\n    var jsCmd = {\n      command: \"play\",\n      streamId: streamId,\n      token: token,\n      room: roomId\n    };\n\n    thiz.webSocketAdaptor.send(JSON.stringify(jsCmd));\n  };\n\n  this.stop = function(streamId) {\n    thiz.closePeerConnection(streamId);\n\n    var jsCmd = {\n      command: \"stop\",\n      streamId: streamId\n    };\n\n    thiz.webSocketAdaptor.send(JSON.stringify(jsCmd));\n  };\n\n  this.join = function(streamId) {\n    var jsCmd = {\n      command: \"join\",\n      streamId: streamId\n    };\n\n    thiz.webSocketAdaptor.send(JSON.stringify(jsCmd));\n  };\n\n  this.leaveFromRoom = function(roomName) {\n    thiz.roomName = roomName;\n    var jsCmd = {\n      command: \"leaveFromRoom\",\n      room: roomName\n    };\n    devLog(\"leave request is sent for \" + roomName);\n\n    thiz.webSocketAdaptor.send(JSON.stringify(jsCmd));\n  };\n\n  this.leave = function(streamId) {\n    var jsCmd = {\n      command: \"leave\",\n      streamId: streamId\n    };\n\n    thiz.webSocketAdaptor.send(JSON.stringify(jsCmd));\n    thiz.closePeerConnection(streamId);\n  };\n\n  this.getStreamInfo = function(streamId) {\n    var jsCmd = {\n      command: \"getStreamInfo\",\n      streamId: streamId\n    };\n    this.webSocketAdaptor.send(JSON.stringify(jsCmd));\n  };\n\n  this.gotStream = function(stream) {\n    thiz.localStream = stream;\n    thiz.localVideo.srcObject = stream;\n    if (\n      thiz.webSocketAdaptor == null ||\n      thiz.webSocketAdaptor.isConnected() == false\n    ) {\n      thiz.webSocketAdaptor = new WebSocketAdaptor();\n    }\n  };\n\n  this.switchVideoCapture = function(streamId) {\n    var mediaConstraints = {\n      video: true,\n      audio: false\n    };\n\n    thiz.switchVideoSource(streamId, mediaConstraints, null);\n  };\n\n  this.switchDesktopCapture = function(streamId) {\n    var screenShareExtensionCallback = function(message) {\n      if (message.data == \"rtcmulticonnection-extension-loaded\") {\n        devLog(\"rtcmulticonnection-extension-loaded parameter is received\");\n        window.postMessage(\"get-sourceId\", \"*\");\n      } else if (message.data == \"PermissionDeniedError\") {\n        devLog(\"Permission denied error\");\n        thiz.callbackError(\"screen_share_permission_denied\");\n      } else if (message.data && message.data.sourceId) {\n        var mediaConstraints = {\n          audio: false,\n          video: {\n            mandatory: {\n              chromeMediaSource: \"desktop\",\n              chromeMediaSourceId: message.data.sourceId\n            },\n            optional: []\n          }\n        };\n\n        thiz.switchVideoSource(streamId, mediaConstraints, function() {\n          thiz.callback(\"screen_share_stopped\");\n          thiz.switchVideoCapture(streamId);\n        });\n\n        //remove event listener\n        window.removeEventListener(\"message\", screenShareExtensionCallback);\n      }\n    };\n\n    //add event listener for desktop capture\n    window.addEventListener(\"message\", screenShareExtensionCallback, false);\n\n    window.postMessage(\"are-you-there\", \"*\");\n  };\n\n  thiz.arrangeStreams = function(stream, onEndedCallback) {\n    var videoTrack = thiz.localStream.getVideoTracks()[0];\n    thiz.localStream.removeTrack(videoTrack);\n    videoTrack.stop();\n    thiz.localStream.addTrack(stream.getVideoTracks()[0]);\n    thiz.localVideo.srcObject = thiz.localStream;\n    if (onEndedCallback != null) {\n      stream.getVideoTracks()[0].onended = function(event) {\n        onEndedCallback(event);\n      };\n    }\n  };\n\n  this.switchVideoSource = function(\n    streamId,\n    mediaConstraints,\n    onEndedCallback\n  ) {\n    navigator.mediaDevices\n      .getUserMedia(mediaConstraints)\n      .then(function(stream) {\n        if (thiz.remotePeerConnection[streamId] != null) {\n          var videoTrackSender = thiz.remotePeerConnection[streamId]\n            .getSenders()\n            .find(function(s) {\n              return s.track.kind == \"video\";\n            });\n\n          videoTrackSender\n            .replaceTrack(stream.getVideoTracks()[0])\n            .then(function() {\n              thiz.arrangeStreams(stream, onEndedCallback);\n            })\n            .catch(function(error) {\n              devLog(error.name);\n            });\n        } else {\n          thiz.arrangeStreams(stream, onEndedCallback);\n        }\n      })\n      .catch(function(error) {\n        thiz.callbackError(error.name);\n      });\n  };\n\n  this.onTrack = function(event, streamId) {\n    devLog(\"onTrack\");\n    if (thiz.remoteVideo != null) {\n      //thiz.remoteVideo.srcObject = event.streams[0];\n      if (thiz.remoteVideo.srcObject !== event.streams[0]) {\n        thiz.remoteVideo.srcObject = event.streams[0];\n        devLog(\"Received remote stream\");\n      }\n    } else {\n      var dataObj = {\n        track: event.streams[0],\n        streamId: streamId\n      };\n      thiz.callback(\"newStreamAvailable\", dataObj);\n    }\n  };\n\n  this.iceCandidateReceived = function(event, streamId) {\n    if (event.candidate) {\n      var jsCmd = {\n        command: \"takeCandidate\",\n        streamId: streamId,\n        label: event.candidate.sdpMLineIndex,\n        id: event.candidate.sdpMid,\n        candidate: event.candidate.candidate\n      };\n\n      if (thiz.debug) {\n        devLog(\"sending ice candiate for stream Id \" + streamId);\n        devLog(JSON.stringify(event.candidate));\n      }\n\n      thiz.webSocketAdaptor.send(JSON.stringify(jsCmd));\n    }\n  };\n\n  this.initPeerConnection = function(streamId) {\n    if (thiz.remotePeerConnection[streamId] == null) {\n      var closedStreamId = streamId;\n      devLog(\n        \"stream id in init peer connection: \" +\n          streamId +\n          \" close dstream id: \" +\n          closedStreamId\n      );\n      thiz.remotePeerConnection[streamId] = new RTCPeerConnection(\n        thiz.peerconnection_config\n      );\n      thiz.remoteDescriptionSet[streamId] = false;\n      thiz.iceCandidateList[streamId] = new Array();\n      if (!thiz.playStreamId.includes(streamId)) {\n        thiz.remotePeerConnection[streamId].addStream(thiz.localStream);\n      }\n      thiz.remotePeerConnection[streamId].onicecandidate = function(event) {\n        thiz.iceCandidateReceived(event, closedStreamId);\n      };\n      thiz.remotePeerConnection[streamId].ontrack = function(event) {\n        thiz.onTrack(event, closedStreamId);\n      };\n    }\n  };\n\n  this.closePeerConnection = function(streamId) {\n    if (\n      thiz.remotePeerConnection[streamId] != null &&\n      thiz.remotePeerConnection[streamId].signalingState != \"closed\"\n    ) {\n      thiz.remotePeerConnection[streamId].close();\n      thiz.remotePeerConnection[streamId] = null;\n      delete thiz.remotePeerConnection[streamId];\n      var playStreamIndex = thiz.playStreamId.indexOf(streamId);\n      if (playStreamIndex != -1) {\n        thiz.playStreamId.splice(playStreamIndex, 1);\n      }\n    }\n  };\n\n  this.signallingState = function(streamId) {\n    if (thiz.remotePeerConnection[streamId] != null) {\n      return thiz.remotePeerConnection[streamId].signalingState;\n    }\n    return null;\n  };\n\n  this.iceConnectionState = function(streamId) {\n    if (thiz.remotePeerConnection[streamId] != null) {\n      return thiz.remotePeerConnection[streamId].iceConnectionState;\n    }\n    return null;\n  };\n\n  this.gotDescription = function(configuration, streamId) {\n    thiz.remotePeerConnection[streamId]\n      .setLocalDescription(configuration)\n      .then(function() {\n        devLog(\"Set local description successfully for stream Id \" + streamId);\n\n        var jsCmd = {\n          command: \"takeConfiguration\",\n          streamId: streamId,\n          type: configuration.type,\n          sdp: configuration.sdp\n        };\n\n        if (thiz.debug) {\n          devLog(\"local sdp: \");\n          devLog(configuration.sdp);\n        }\n\n        thiz.webSocketAdaptor.send(JSON.stringify(jsCmd));\n      })\n      .catch(function(error) {\n        devLog(\"Cannot set local description. Error is: \" + error);\n      });\n  };\n\n  this.turnOffLocalCamera = function() {\n    if (thiz.remotePeerConnection != null) {\n      var track = thiz.localStream.getVideoTracks()[0];\n      track.enabled = false;\n    } else {\n      this.callbackError(\"NoActiveConnection\");\n    }\n  };\n\n  this.turnOnLocalCamera = function() {\n    if (thiz.remotePeerConnection != null) {\n      var track = thiz.localStream.getVideoTracks()[0];\n      track.enabled = true;\n    } else {\n      this.callbackError(\"NoActiveConnection\");\n    }\n  };\n\n  this.muteLocalMic = function() {\n    if (thiz.remotePeerConnection != null) {\n      var track = thiz.localStream.getAudioTracks()[0];\n      track.enabled = false;\n    } else {\n      this.callbackError(\"NoActiveConnection\");\n    }\n  };\n\n  /**\n   * if there is audio it calls callbackError with \"AudioAlreadyActive\" parameter\n   */\n  this.unmuteLocalMic = function() {\n    if (thiz.remotePeerConnection != null) {\n      var track = thiz.localStream.getAudioTracks()[0];\n      track.enabled = true;\n    } else {\n      this.callbackError(\"NoActiveConnection\");\n    }\n  };\n\n  this.takeConfiguration = function(\n    idOfStream,\n    configuration,\n    typeOfConfiguration\n  ) {\n    var streamId = idOfStream;\n    var type = typeOfConfiguration;\n    var conf = configuration;\n\n    thiz.initPeerConnection(streamId);\n\n    thiz.remotePeerConnection[streamId]\n      .setRemoteDescription(\n        new RTCSessionDescription({\n          sdp: conf,\n          type: type\n        })\n      )\n      .then(function(response) {\n        if (thiz.debug) {\n          devLog(\n            \"set remote description is succesfull with response: \" +\n              response +\n              \" for stream : \" +\n              streamId +\n              \" and type: \" +\n              type\n          );\n          devLog(conf);\n        }\n\n        thiz.remoteDescriptionSet[streamId] = true;\n        var length = thiz.iceCandidateList[streamId].length;\n        devLog(\"Ice candidate list size to be added: \" + length);\n        for (var i = 0; i < length; i++) {\n          thiz.addIceCandidate(streamId, thiz.iceCandidateList[streamId][i]);\n        }\n        thiz.iceCandidateList[streamId] = [];\n\n        if (type == \"offer\") {\n          //SDP constraints may be different in play mode\n          devLog(\"try to create answer for stream id: \" + streamId);\n\n          thiz.remotePeerConnection[streamId]\n            .createAnswer(thiz.sdp_constraints)\n            .then(function(configuration) {\n              devLog(\"created answer for stream id: \" + streamId);\n              thiz.gotDescription(configuration, streamId);\n            })\n            .catch(function(error) {\n              devLog(\"create answer error :\" + error);\n            });\n        }\n      })\n      .catch(function(error) {\n        if (thiz.debug) {\n          devLog(\"set remote description is failed with error: \" + error);\n        }\n      });\n  };\n\n  this.takeCandidate = function(idOfTheStream, tmpLabel, tmpCandidate) {\n    var streamId = idOfTheStream;\n    var label = tmpLabel;\n    var candidateSdp = tmpCandidate;\n\n    var candidate = new RTCIceCandidate({\n      sdpMLineIndex: label,\n      candidate: candidateSdp\n    });\n\n    thiz.initPeerConnection(streamId);\n\n    if (thiz.remoteDescriptionSet[streamId] == true) {\n      thiz.addIceCandidate(streamId, candidate);\n    } else {\n      devLog(\n        \"Ice candidate is added to list because remote description is not set yet\"\n      );\n      thiz.iceCandidateList[streamId].push(candidate);\n    }\n  };\n\n  this.addIceCandidate = function(streamId, candidate) {\n    thiz.remotePeerConnection[streamId]\n      .addIceCandidate(candidate)\n      .then(function() {\n        if (thiz.debug) {\n          devLog(\"Candidate is added for stream \" + streamId);\n        }\n      })\n      .catch(function(error) {\n        devLog(\n          \"ice candiate cannot be added for stream id: \" +\n            streamId +\n            \" error is: \" +\n            error\n        );\n        devLog(candidate);\n      });\n  };\n\n  this.startPublishing = function(idOfStream) {\n    var streamId = idOfStream;\n\n    thiz.initPeerConnection(streamId);\n\n    thiz.remotePeerConnection[streamId]\n      .createOffer(thiz.sdp_constraints)\n      .then(function(configuration) {\n        thiz.gotDescription(configuration, streamId);\n      })\n      .catch(function(error) {\n        devLog(\n          \"create offer error for stream id: \" + streamId + \" error: \" + error\n        );\n      });\n  };\n\n  /**\n   * After calling this function, create new WebRTCAdaptor instance, don't use the the same objectone\n   * Because all streams are closed on server side as well when websocket connection is closed.\n   */\n  this.closeWebSocket = function() {\n    for (var key in thiz.remotePeerConnection) {\n      thiz.remotePeerConnection[key].close();\n    }\n    //free the remote peer connection by initializing again\n    thiz.remotePeerConnection = new Array();\n    thiz.webSocketAdaptor.close();\n  };\n\n  function WebSocketAdaptor() {\n    var wsConn = new WebSocket(thiz.websocket_url);\n\n    var connected = false;\n\n    var pingTimerId = -1;\n\n    var clearPingTimer = function() {\n      if (pingTimerId != -1) {\n        if (thiz.debug) {\n          devLog(\"Clearing ping message timer\");\n        }\n        clearInterval(pingTimerId);\n        pingTimerId = -1;\n      }\n    };\n\n    var sendPing = function() {\n      wsConn.send;\n\n      var jsCmd = {\n        command: \"ping\"\n      };\n      wsConn.send(JSON.stringify(jsCmd));\n    };\n\n    this.close = function() {\n      wsConn.close();\n    };\n\n    wsConn.onopen = function() {\n      if (thiz.debug) {\n        devLog(\"websocket connected\");\n      }\n\n      pingTimerId = setInterval(() => {\n        sendPing();\n      }, 5000);\n\n      connected = true;\n      thiz.callback(\"initialized\");\n    };\n\n    this.send = function(text) {\n      if (\n        wsConn.readyState == 0 ||\n        wsConn.readyState == 2 ||\n        wsConn.readyState == 3\n      ) {\n        thiz.callbackError(\"WebSocketNotConnected\");\n        return;\n      }\n      wsConn.send(text);\n      devLog(\"sent message:\" + text);\n    };\n\n    this.isConnected = function() {\n      return connected;\n    };\n\n    wsConn.onmessage = function(event) {\n      var obj = JSON.parse(event.data);\n\n      if (obj.command == \"start\") {\n        //this command is received first, when publishing so playmode is false\n\n        if (thiz.debug) {\n          devLog(\"received start command\");\n        }\n\n        thiz.startPublishing(obj.streamId);\n      } else if (obj.command == \"takeCandidate\") {\n        if (thiz.debug) {\n          devLog(\"received ice candidate for stream id \" + obj.streamId);\n          devLog(obj.candidate);\n        }\n\n        thiz.takeCandidate(obj.streamId, obj.label, obj.candidate);\n      } else if (obj.command == \"takeConfiguration\") {\n        if (thiz.debug) {\n          devLog(\n            \"received remote description type for stream id: \" +\n              obj.streamId +\n              \" type: \" +\n              obj.type\n          );\n        }\n        thiz.takeConfiguration(obj.streamId, obj.sdp, obj.type);\n      } else if (obj.command == \"stop\") {\n        devLog(\"Stop command received\");\n        thiz.closePeerConnection(obj.streamId);\n      } else if (obj.command == \"error\") {\n        thiz.callbackError(obj.definition);\n      } else if (obj.command == \"notification\") {\n        thiz.callback(obj.definition, obj);\n        if (\n          obj.definition == \"play_finished\" ||\n          obj.definition == \"publish_finished\"\n        ) {\n          thiz.closePeerConnection(obj.streamId);\n        }\n      } else if (obj.command == \"streamInformation\") {\n        thiz.callback(obj.command, obj);\n      } else if (obj.command == \"pong\") {\n        thiz.callback(obj.command);\n      }\n    };\n\n    wsConn.onerror = function(error) {\n      devLog(\" error occured: \" + JSON.stringify(error));\n      clearPingTimer();\n      thiz.callbackError(error);\n    };\n\n    wsConn.onclose = function(event) {\n      connected = false;\n      devLog(\"connection closed.\");\n      clearPingTimer();\n      thiz.callback(\"closed\", event);\n    };\n  }\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar $indexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar nativeIndexOf = [].indexOf;\n\nvar NEGATIVE_ZERO = !!nativeIndexOf && 1 / [1].indexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.indexOf` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? nativeIndexOf.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $includes = require('../internals/array-includes').includes;\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.includes` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.includes\n$({ target: 'Array', proto: true, forced: !USES_TO_LENGTH }, {\n  includes: function includes(el /* , fromIndex = 0 */) {\n    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('includes');\n"],"sourceRoot":""}