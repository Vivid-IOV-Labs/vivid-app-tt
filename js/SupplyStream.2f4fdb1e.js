(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["SupplyStream"],{"860a":function(e,t,o){"use strict";o.r(t);var s,a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-ons-page",{attrs:{id:"Streamer"}},[o("div",{staticClass:"stream__container"},[o("div",{staticClass:"stream__controls stream__controls--top"},[o("v-ons-button",{staticClass:"btn btn--small btn--opacity-soft  flex-center-xy"},[o("base-icon",{staticClass:"btn__icon",attrs:{name:"user"}}),o("span",{staticClass:"ml-2"},[e._v("101")])],1),o("v-ons-button",{staticClass:"btn btn--small btn--opacity-soft ml-auto  flex-center-xy"},[o("base-icon",{staticClass:"btn__icon",attrs:{name:"clock"}}),o("span",{staticClass:"ml-2"},[e._v(e._s(e.currentTime))])],1)],1),o("base-video",{ref:"videoplayer",attrs:{options:e.videoOptions},on:{timeupdate:e.updateLiveTime}}),o("div",{staticClass:"stream__controls stream__controls--bottom"},[e.stop_publish_button.disabled?e._e():o("v-ons-button",{staticClass:"btn btn--opacity-soft btn--full-width",attrs:{id:"stop_publish_button"},on:{click:function(t){e.endStream=!0}}},[e._v("End Streaming "),o("base-icon",{staticClass:"btn__icon",attrs:{name:"pause"}})],1)],1),o("v-ons-alert-dialog",{attrs:{modifier:"rowfooter",title:"Live stream reported",footer:{Ok:e.closeVideoStream},visible:e.streamReported},on:{"update:visible":function(t){e.streamReported=t}}},[e._v(" This Live stream has been reported and therefor ended ")]),o("v-ons-alert-dialog",{attrs:{modifier:"rowfooter",title:"End live stream",footer:{Ok:e.closeVideoStream,Cancel:function(){return e.endStream=!1}},visible:e.endStream},on:{"update:visible":function(t){e.endStream=t}}},[e._v(" Are you sure you want to end this live stream ")])],1)])},i=[],n=(o("c975"),o("1311")),r=o("bd97"),d=o("8055"),c=o.n(d),l=o("3844"),u=o.n(l),p=o("8c89"),b=o("e510");c.a.sails?s=c.a:(s=u()(c.a),s.sails.url=p["a"].web_service_url);var m={name:"supplyStream",components:{BaseVideo:n["a"]},data:function(){return{player:null,videoOptions:{autoplay:!0,muted:!0,liveui:!0,fill:!0,controls:!1},currentTime:"00:00:00",stop_publish_button:{disabled:!0},streamNameBox:this.$store.state.requests.selectedPin.openLocationCode,streamId:"",webRTCAdaptor:"",streamReported:!1,endStream:!1,openLocationCode:""}},methods:{closeVideoStream:function(){this.stopPublishing(),this.webRTCAdaptor.closeStream(),this.webRTCAdaptor.closePeerConnection(),this.webRTCAdaptor.closeWebSocket(),this.$router.push({path:"home"})},startPublishing:function(){this.streamId=this.streamNameBox,this.webRTCAdaptor.publish(this.streamId,"287084795627827033631286")},stopPublishing:function(){this.webRTCAdaptor.stop(this.streamId)},updateLiveTime:function(e){this.currentTime=e}},mounted:function(){var e=this;s.socket.on("request-deleted-flag-reported",(function(t){var o=t.data;e.openLocationCode=o.openLocationCode,e.streamReported=!0})),this.player=this.$refs.videoplayer.$refs.video;var t=null,o={OfferToReceiveAudio:!1,OfferToReceiveVideo:!1},a={video:!0,audio:!0};this.webRTCAdaptor=new r["a"]({websocket_url:"wss://streams.vividiov.media:5443/WebRTCAppEE/websocket",mediaConstraints:a,peerconnection_config:t,sdp_constraints:o,localVideoId:this.player,debug:!1,callback:function(t,o){"initialized"==t?(Object(b["a"])("initialized"),e.stop_publish_button.disabled=!0,e.startPublishing()):"publish_started"==t?(Object(b["a"])("publish started"),e.stop_publish_button.disabled=!1):"publish_finished"==t?(Object(b["a"])("publish finished"),e.stop_publish_button.disabled=!0):"screen_share_extension_available"==t||("screen_share_stopped"==t?Object(b["a"])("screen share stopped"):"closed"==t&&(Object(b["a"])("Connection closed"),"undefined"!=typeof o&&Object(b["a"])("Connecton closed: "+JSON.stringify(o))))},callbackError:function(e,t){Object(b["a"])("error callback: "+JSON.stringify(e));var o=JSON.stringify(e);"undefined"!=typeof t&&(o=t),-1!=e.indexOf("NotFoundError")?o="Camera or Mic are not found or not allowed in your device.":-1!=e.indexOf("NotReadableError")||-1!=e.indexOf("TrackStartError")?o="Camera or Mic is being used by some other process that does not not allow these devices to be read.":-1!=e.indexOf("OverconstrainedError")||-1!=e.indexOf("ConstraintNotSatisfiedError")?o="There is no device found that fits your video and audio constraints. You may change video and audio constraints.":-1!=e.indexOf("NotAllowedError")||-1!=e.indexOf("PermissionDeniedError")?o="You are not allowed to access camera and mic.":-1!=e.indexOf("TypeError")?o="Video/Audio is required.":-1!=e.indexOf("UnsecureContext")?o="Fatal Error: Browser cannot access camera and mic because of unsecure context. Please install SSL and access via https":-1!=e.indexOf("WebSocketNotSupported")&&(o="Fatal Error: WebSocket not supported in this browser"),alert(o)}})}},f=m,h=o("2877"),v=Object(h["a"])(f,a,i,!1,null,null,null);t["default"]=v.exports}}]);
//# sourceMappingURL=SupplyStream.2f4fdb1e.js.map